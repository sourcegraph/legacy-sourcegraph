query CommitPage_CommitQuery($repoName: String!, $revspec: String!) {
    repository(name: $repoName) {
        id
        commit(rev: $revspec) {
            ...CommitPage_Commit
        }
    }
}

query CommitPage_Changelist($repoName: String!, $changelistId: String!) {
    repository(name: $repoName) {
        sourceType
        changelist(cid: $changelistId) {
            __typename
            ...PerforceChangelistFields
        }
    }
}

fragment PerforceChangelistFields on PerforceChangelist {
    cid
    canonicalURL
    commit {
        ...CommitPage_Commit
    }
}

fragment CommitPage_Commit on GitCommit {
        id
        oid
        perforceChangelist {
            cid
            canonicalURL
        }
        parents {
            id
            oid
            abbreviatedOID
            canonicalURL
        }
        externalURLs {
            url
            serviceKind
        }
        ...Commit
        __typename
}

query CommitPage_DiffQuery($repoName: String!, $base: String, $head: String, $first: Int, $after: String) {
    repository(name: $repoName) {
        id
        comparison(base: $base, head: $head) {
            fileDiffs(first: $first, after: $after) {
                ...CommitPage_DiffConnection
            }
        }
    }
}

fragment CommitPage_DiffConnection on FileDiffConnection {
    nodes {
        ...FileDiff_Diff
    }
    pageInfo {
        endCursor
        hasNextPage
    }
}
