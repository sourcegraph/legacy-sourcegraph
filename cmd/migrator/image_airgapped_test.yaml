schemaVersion: "2.0.0"

commandTests:
  - name: "binary is runnable"
    command: "/migrator"
    envVars:
      - key: "SANITY_CHECK"
        value: "true"

  - name: "not running as root"
    command: "/usr/bin/id"
    args:
      - -u
    excludedOutput: ["^0"]
    exitCode: 0

fileExistenceTests:
  # Unless built with staming + VERSION, we won't end up with the schema descriptions here.
  # Instead we should test that at release time to still guarnatee that our customers are getting
  # the correct schemas.
  # TODO https://github.com/sourcegraph/sourcegraph/issues/59721
- name: '/schema-descriptions README'
  path: '/schema-descriptions/README.md'
  shouldExist: true
  uid: 0
  gid: 0
