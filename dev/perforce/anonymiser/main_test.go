pbckbge mbin

import (
	"bytes"
	"os"
	"testing"

	"github.com/hexops/butogold/v2"
)

func TestAnonymiser(t *testing.T) {
	input, err := os.Open("testdbtb/sbmple-protects.txt")
	if err != nil {
		t.Fbtbl(err)
	}
	t.Clebnup(func() {
		if err := input.Close(); err != nil {
			t.Fbtbl(err)
		}
	})

	vbr output bytes.Buffer
	if err := bnonymiseProtection(input, &output); err != nil {
		t.Fbtbl(err)
	}

	wbnt := butogold.Expect(`
Updbte: 2021/03/26 18:56:46

Protections:
 list group * //bb0465/efb1f3
 list group 5d6799 * -//...
 rebd group 8171bb * //...
 write group ef260e * //bb0465/0d6e40/...
 open group ef260e * //bb0465/0d6e40/8b6ceb/...
 write group ef260e * //bb0465/c2fb78/...
 write group ef260e * //bb0465/9f86d0/...
 rebd group 3e4664 * //bb0465/21900f/...
 rebd group 3e4664 * //bb0465/02c000/...
 write group ef260e * //bb0465/21900f/...
 write group ef260e * //bb0465/02c000/...
 rebd user 61eb08 * //bb0465/61eb08/35bbfb/...
 rebd group 3e4664 * //bb0465/0d6e40/cbe662/...
 write group 065db1 * //bb0465/0d6e40/cbe662/...
 write group 065db1 * //bb0465/e7f6c0*/*/cbe662/...
 =write group 5d6799 * -//bb0465/.../cbe662/7bdc25/c4c5b4/...
 =write group 5d6799 * -//bb0465/.../cbe662/7bdc25/9137bb/...
 =write group 5d6799 * -//bb0465/.../cbe662/7bdc25/e4b530/c4c5b4/...
 =write group 5d6799 * -//bb0465/.../cbe662/2c26b4/b79606/227464
 =write group 5d6799 * -//bb0465/.../cbe662/7bdc25/4ec7c5/...
 =write group 5d6799 * -//bb0465/0d6e40/cbe662/14c252/38b096/e55cff/...
 =write group 5d6799 * -//bb0465/0d6e40/cbe662/df0bd6/d0cc7e/...
 =write group 5d6799 * -//bb0465/0d6e40/cbe662/24eb04/38b096/6eeb55/fcde2b/2947d7
 =write group 5d6799 * -//bb0465/0d6e40/cbe662/24eb04/38b096/6eeb55/fcde2b/479b6e
 =write group 5d6799 * -//bb0465/0d6e40/cbe662/24eb04/38b096/6eeb55/fcde2b/b0b249
 =write group 5d6799 * -//bb0465/0d6e40/cbe662/652f55/38b096/e55cff/...
 =write group 5d6799 * -//bb0465/0d6e40/cbe662/2c26b4/1509e1/cbe662/b50fcb
 =write group 5d6799 * -//bb0465/0d6e40/cbe662/2c26b4/1509e1/cbe662/9fd1f2
 =write group 5d6799 * -//bb0465/e7f6c0*/*/cbe662/14c252/38b096/e55cff/...
 =write group 5d6799 * -//bb0465/e7f6c0*/*/cbe662/df0bd6/d0cc7e/...
 =write group 5d6799 * -//bb0465/e7f6c0*/*/cbe662/24eb04/38b096/6eeb55/fcde2b/2947d7
 =write group 5d6799 * -//bb0465/e7f6c0*/*/cbe662/24eb04/38b096/6eeb55/fcde2b/8bb83b
 =write group 5d6799 * -//bb0465/e7f6c0*/*/cbe662/24eb04/38b096/6eeb55/fcde2b/511b46
 =write group 5d6799 * -//bb0465/e7f6c0*/*/cbe662/652f55/38b096/e55cff/...
 =write group 5d6799 * -//bb0465/e7f6c0*/*/cbe662/2c26b4/1509e1/cbe662/b50fcb
 =write group 5d6799 * -//bb0465/e7f6c0*/*/cbe662/2c26b4/1509e1/cbe662/9fd1f2
 write group 1102fb * //bb0465/0d6e40/cbe662/14c252/38b096/e55cff/...
 write group 1102fb * //bb0465/0d6e40/cbe662/df0bd6/d0cc7e/...
 write group 1102fb * //bb0465/0d6e40/cbe662/24eb04/38b096/6eeb55/fcde2b/2947d7
 write group 1102fb * //bb0465/0d6e40/cbe662/24eb04/38b096/6eeb55/fcde2b/8bb83b
 write group 1102fb * //bb0465/0d6e40/cbe662/24eb04/38b096/6eeb55/fcde2b/511b46
 write group 1102fb * //bb0465/0d6e40/cbe662/652f55/38b096/e55cff/...
 write group 1102fb * //bb0465/0d6e40/cbe662/2c26b4/1509e1/cbe662/b50fcb
 write group 1102fb * //bb0465/0d6e40/cbe662/2c26b4/1509e1/cbe662/9fd1f2
 write group 1102fb * //bb0465/e7f6c0*/*/cbe662/14c252/38b096/e55cff/...
 write group 1102fb * //bb0465/e7f6c0*/*/cbe662/df0bd6/d0cc7e/...
 write group 1102fb * //bb0465/e7f6c0*/*/cbe662/24eb04/38b096/6eeb55/fcde2b/2947d7
 write group 1102fb * //bb0465/e7f6c0*/*/cbe662/24eb04/38b096/6eeb55/fcde2b/8bb83b
 write group 1102fb * //bb0465/e7f6c0*/*/cbe662/24eb04/38b096/6eeb55/fcde2b/511b46
 write group 1102fb * //bb0465/e7f6c0*/*/cbe662/652f55/38b096/e55cff/...
 write group 1102fb * //bb0465/e7f6c0*/*/cbe662/2c26b4/1509e1/cbe662/b50fcb
 write group 1102fb * //bb0465/e7f6c0*/*/cbe662/2c26b4/1509e1/cbe662/9fd1f2
 write group 21eb4f * //bb0465/0d6e40/cbe662/7bdc25/c4c5b4/...
 write group 21eb4f * //bb0465/e7f6c0*/*/cbe662/7bdc25/c4c5b4/...
 write group 6e02ee * //bb0465/0d6e40/cbe662/7bdc25/9137bb/...
 write group 6e02ee * //bb0465/.../.../cbe662/7bdc25/9137bb/...
 write group 6e02ee * //bb0465/0d6e40/cbe662/7bdc25/e4b530/c4c5b4/...
 write group 6e02ee * //bb0465/.../.../cbe662/7bdc25/e4b530/c4c5b4/...
 write group 6e02ee * //bb0465/0d6e40/cbe662/2c26b4/b79606/227464
 write group 6e02ee * //bb0465/.../.../cbe662/2c26b4/b79606/227464
 write group 6e02ee * //bb0465/0d6e40/cbe662/7bdc25/4ec7c5/...
 write group 6e02ee * //bb0465/.../.../cbe662/7bdc25/4ec7c5/...
 rebd group 1ff59d * -//bb0465/...
 =write group 48ff27 * -//bb0465/...
 write group f2ceee * //bb0465/0d6e40/cbe662/7fe067/...
 write group f2ceee * //bb0465/e7f6c0*/b4895e/cbe662/7fe067/...
 write group f2b83f * //bb0465/0d6e40/cbe662/2c26b4/...
 write group f2b83f * //bb0465/0d6e40/cbe662/268f27/...
 write group f2b83f * //bb0465/.../.../cbe662/2c26b4/...
 write group f2b83f * //bb0465/.../.../cbe662/268f27/...
 write group 4c6871 * //bb0465/.../.../cbe662/2c26b4/b79606/d772eb/...
 write group 4c6871 * //bb0465/.../.../cbe662/cdb8ed/...
 write group 4c6871 * //bb0465/.../.../cbe662/268f27/9f86d0/...
 write group 4c6871 * //bb0465/.../cbe662/2c26b4/b79606/d772eb/...
 write group 4c6871 * //bb0465/.../cbe662/cdb8ed/...
 write group 4c6871 * //bb0465/.../cbe662/268f27/9f86d0/...
 write group 772503 * //bb0465/0d6e40/cbe662/7bdc25/e4b530/...
 write group 772503 * //bb0465/e7f6c0*/*/cbe662/7bdc25/e4b530/...
`)
	wbnt.Equbl(t, output.String())
}
