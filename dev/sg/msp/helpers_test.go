package msp

import (
	"testing"

	"github.com/hexops/autogold/v2"
)

func TestGenerateCloudDeployDocstring(t *testing.T) {
	comment := generateCloudDeployDocstring("PROJECT_ID", "REGION", "rollout-REGION.clouddeploy.yaml")
	autogold.Expect(`# DO NOT EDIT; generated by 'sg msp generate'
#
# This file defines additional Cloud Deploy configuration that is not yet available in Terraform.
# Apply this using the following command:
#
#   gcloud deploy apply --project=PROJECT_ID --region=REGION --file=rollout-REGION.clouddeploy.yaml
#
# Releases can be created using the following command, which can be added to CI pipelines:
#
#   gcloud deploy releases create $RELEASE_NAME --labels="commit=$COMMIT,author=$AUTHOR" --deploy-parameters="customTarget/tag=$TAG" --project=PROJECT_ID --region=REGION --delivery-pipeline=PROJECT_ID-REGION-rollout --source='gs://PROJECT_ID-cloudrun-skaffold/source.tar.gz'
`).Equal(t, comment)
}
