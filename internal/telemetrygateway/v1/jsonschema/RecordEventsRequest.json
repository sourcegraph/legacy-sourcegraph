{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "$ref": "#/definitions/RecordEventsRequest",
    "definitions": {
        "RecordEventsRequest": {
            "properties": {
                "metadata": {
                    "$ref": "#/definitions/telemetrygateway.v1.RecordEventsRequestMetadata",
                    "additionalProperties": true,
                    "description": "Metadata about the events being recorded."
                },
                "events": {
                    "$ref": "#/definitions/telemetrygateway.v1.RecordEventsRequest.EventsPayload",
                    "additionalProperties": true,
                    "description": "Batch of events to record in a single request. Clients should aim to batch large event backlogs into a series of smaller requests in the RecordEvents stream, being mindful of common limits in individual message sizes: https://protobuf.dev/programming-guides/api/#bound-req-res-sizes"
                }
            },
            "additionalProperties": true,
            "type": "object",
            "title": "Record Events Request"
        },
        "telemetrygateway.v1.Event": {
            "properties": {
                "id": {
                    "type": "string",
                    "description": "Generated ID of the event, currently expected to be UUID v4."
                },
                "timestamp": {
                    "type": "string",
                    "description": "Timestamp of when the original event was recorded.",
                    "format": "date-time"
                },
                "feature": {
                    "type": "string",
                    "description": "Feature associated with the event in camelCase, e.g. 'myFeature'."
                },
                "action": {
                    "type": "string",
                    "description": "Action associated with the event in camelCase, e.g. 'pageView'."
                },
                "source": {
                    "$ref": "#/definitions/telemetrygateway.v1.EventSource",
                    "additionalProperties": true,
                    "description": "Source of the event."
                },
                "parameters": {
                    "$ref": "#/definitions/telemetrygateway.v1.EventParameters",
                    "additionalProperties": true,
                    "description": "Parameters of the event."
                },
                "user": {
                    "$ref": "#/definitions/telemetrygateway.v1.EventUser",
                    "additionalProperties": true,
                    "description": "Optional user associated with the event. This field should be hydrated by the Sourcegraph server, and not provided by clients."
                },
                "feature_flags": {
                    "$ref": "#/definitions/telemetrygateway.v1.EventFeatureFlags",
                    "additionalProperties": true,
                    "description": "Optional feature flags configured in the context of the event."
                },
                "marketing_tracking": {
                    "$ref": "#/definitions/telemetrygateway.v1.EventMarketingTracking",
                    "additionalProperties": true,
                    "description": "Optional marketing campaign tracking parameters. ðŸš¨ SECURITY: This metadata is NEVER exported from an instance, and is only exported for events tracked in the public Sourcegraph.com instance."
                }
            },
            "additionalProperties": true,
            "type": "object",
            "title": "Event"
        },
        "telemetrygateway.v1.EventBillingMetadata": {
            "properties": {
                "product": {
                    "type": "string",
                    "description": "Billing product ID associated with the event."
                },
                "category": {
                    "type": "string",
                    "description": "Billing category ID the event falls into."
                }
            },
            "additionalProperties": true,
            "type": "object",
            "title": "Event Billing Metadata"
        },
        "telemetrygateway.v1.EventFeatureFlags": {
            "properties": {
                "flags": {
                    "additionalProperties": {
                        "type": "string"
                    },
                    "type": "object",
                    "description": "Evaluated feature flags. In Soucegraph we currently only support boolean feature flags, but in the API we allow arbitrary string values for future extensibility. This field should be hydrated by the Sourcegraph server, and not provided by clients."
                }
            },
            "additionalProperties": true,
            "type": "object",
            "title": "Event Feature Flags"
        },
        "telemetrygateway.v1.EventMarketingTracking": {
            "properties": {
                "url": {
                    "type": "string",
                    "description": "URL the event occurred on."
                },
                "first_source_url": {
                    "type": "string",
                    "description": "Initial URL the user landed on."
                },
                "cohort_id": {
                    "type": "string",
                    "description": "Cohort ID to identify the user as part of a specific A/B test."
                },
                "referrer": {
                    "type": "string",
                    "description": "Referrer URL that refers the user to Sourcegraph."
                },
                "last_source_url": {
                    "type": "string",
                    "description": "Last source URL visited by the user."
                },
                "device_session_id": {
                    "type": "string",
                    "description": "Device session ID to identify the user's session."
                },
                "session_referrer": {
                    "type": "string",
                    "description": "Session referrer URL for the user."
                },
                "session_first_url": {
                    "type": "string",
                    "description": "First URL the user visited in their current session."
                }
            },
            "additionalProperties": true,
            "type": "object",
            "title": "Event Marketing Tracking",
            "description": "Marketing campaign tracking metadata. ðŸš¨ SECURITY: This metadata is NEVER exported from private Sourcegraph instances, and is only exported for events tracked in the public Sourcegraph.com instance."
        },
        "telemetrygateway.v1.EventParameters": {
            "properties": {
                "version": {
                    "type": "integer",
                    "description": "Version of the event parameters, used for indicating the \"shape\" of this event's metadata, beginning at 0. Useful for denoting if the shape of metadata has changed in any way."
                },
                "metadata": {
                    "additionalProperties": {
                        "type": "string"
                    },
                    "type": "object",
                    "description": "Strictly typed metadata, restricted to integer values to avoid accidentally exporting sensitive or private data."
                },
                "private_metadata": {
                    "additionalProperties": true,
                    "type": "object",
                    "description": "Additional potentially sensitive metadata - i.e. not restricted to integer values. ðŸš¨ SECURITY: This metadata is NOT exported from instances by default, as it can contain arbitrarily-shaped data that may accidentally contain sensitive or private contents. This metadata is only exported on an allowlist basis based on terms of use agreements and combinations of event feature and action, alongside careful audit of callsites."
                },
                "billing_metadata": {
                    "$ref": "#/definitions/telemetrygateway.v1.EventBillingMetadata",
                    "additionalProperties": true,
                    "description": "Optional billing-related metadata."
                }
            },
            "additionalProperties": true,
            "type": "object",
            "title": "Event Parameters"
        },
        "telemetrygateway.v1.EventSource": {
            "properties": {
                "server": {
                    "$ref": "#/definitions/telemetrygateway.v1.EventSource.Server",
                    "additionalProperties": true,
                    "description": "Information about the Sourcegraph instance that received the event."
                },
                "client": {
                    "$ref": "#/definitions/telemetrygateway.v1.EventSource.Client",
                    "additionalProperties": true,
                    "description": "Information about the client that generated the event."
                }
            },
            "additionalProperties": true,
            "type": "object",
            "title": "Event Source"
        },
        "telemetrygateway.v1.EventSource.Client": {
            "properties": {
                "name": {
                    "type": "string",
                    "description": "Source client of the event."
                },
                "version": {
                    "type": "string",
                    "description": "Version of the cleint."
                }
            },
            "additionalProperties": true,
            "type": "object",
            "title": "Client"
        },
        "telemetrygateway.v1.EventSource.Server": {
            "properties": {
                "version": {
                    "type": "string",
                    "description": "Version of the Sourcegraph server."
                }
            },
            "additionalProperties": true,
            "type": "object",
            "title": "Server"
        },
        "telemetrygateway.v1.EventUser": {
            "properties": {
                "user_id": {
                    "type": "string",
                    "description": "Database user ID of signed in user. User IDs are specific to a Sourcegraph instance, and not universal. We use an int64 as an ID because in Sourcegraph, database user IDs are always integers."
                },
                "anonymous_user_id": {
                    "type": "string",
                    "description": "Randomized unique identifier for an actor (e.g. stored in localstorage in web client)."
                }
            },
            "additionalProperties": true,
            "type": "object",
            "title": "Event User"
        },
        "telemetrygateway.v1.Identifier": {
            "properties": {
                "licensed_instance": {
                    "$ref": "#/definitions/telemetrygateway.v1.Identifier.LicensedInstanceIdentifier",
                    "additionalProperties": true,
                    "description": "A licensed Sourcegraph instance."
                },
                "unlicensed_instance": {
                    "$ref": "#/definitions/telemetrygateway.v1.Identifier.UnlicensedInstanceIdenfitier",
                    "additionalProperties": true,
                    "description": "An unlicensed Sourcegraph instance."
                }
            },
            "additionalProperties": true,
            "type": "object",
            "title": "Identifier"
        },
        "telemetrygateway.v1.Identifier.LicensedInstanceIdentifier": {
            "properties": {
                "license_key": {
                    "type": "string",
                    "description": "License key configured in the Sourcegraph instance emitting the event."
                },
                "instance_id": {
                    "type": "string",
                    "description": "Self-reported Sourcegraph instance identifier."
                }
            },
            "additionalProperties": true,
            "type": "object",
            "title": "Licensed Instance Identifier"
        },
        "telemetrygateway.v1.Identifier.UnlicensedInstanceIdenfitier": {
            "properties": {
                "instance_id": {
                    "type": "string",
                    "description": "Self-reported Sourcegraph instance identifier."
                }
            },
            "additionalProperties": true,
            "type": "object",
            "title": "Unlicensed Instance Idenfitier"
        },
        "telemetrygateway.v1.RecordEventsRequest.EventsPayload": {
            "properties": {
                "events": {
                    "items": {
                        "$ref": "#/definitions/telemetrygateway.v1.Event"
                    },
                    "type": "array"
                }
            },
            "additionalProperties": true,
            "type": "object",
            "title": "Events Payload"
        },
        "telemetrygateway.v1.RecordEventsRequestMetadata": {
            "properties": {
                "request_id": {
                    "type": "string",
                    "description": "Client-provided request identifier for diagnostics purposes."
                },
                "identifier": {
                    "$ref": "#/definitions/telemetrygateway.v1.Identifier",
                    "additionalProperties": true,
                    "description": "Telemetry source self-identification."
                }
            },
            "additionalProperties": true,
            "type": "object",
            "title": "Record Events Request Metadata"
        }
    }
}